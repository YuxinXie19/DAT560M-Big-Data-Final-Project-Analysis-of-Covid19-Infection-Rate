data=sc.textFile('data.csv')
header = data.first()
rows = data.filter(lambda x: x!=header)
result=rows.map(lambda x: x.split(',')).map(lambda x: [x[0], x[1], x[2],x[4],x[5],x[6],x[8],x[9],x[19],x[20],x[41],x[44],x[52],x[116],x[117],x[153],x[192],x[193],x[24]])
df = sqlContext.createDataFrame(result,['date','county','state','cases','deaths','stay_at_home_announced','lat','lon','percent_smokers','percent_adults_with_obesity','percent_vaccinated','population','income_ratio','ercent_less_than_18_years_of_age','percent_65_and_over','percent_unemployed_CDC','min_temp','max_temp','percent_excessive_drinking'])
df.show(5)
df.coalesce(1).write.option("header", "true").csv("data_usacovid.csv")
